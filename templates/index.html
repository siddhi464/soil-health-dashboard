<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Soil Health Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-green-50 text-gray-900 font-sans p-6">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-4">ЁЯМ▒ Soil Health & Biodiversity Dashboard (рдореГрджрд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдФрд░ рдЬреИрд╡ рд╡рд┐рд╡рд┐рдзрддрд╛ рдбреИрд╢рдмреЛрд░реНрдб)</h1>

<!-- Crop Recommendation Form -->
<form action="/get_crop_recommendation" method="POST" class="bg-white p-4 rounded-lg shadow mb-6">
    <h2 class="text-xl font-semibold mb-2">ЁЯМ╛ Crop Recommendation (рдлрд╕рд▓ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢)</h2>
    <input type="text" name="location" placeholder="Enter Location (рд╕реНрдерд╛рди рджрд░реНрдЬ рдХрд░реЗрдВ)" class="border p-2 mb-2 w-full" required />
    <input type="number" name="ph" placeholder="Enter Soil pH (рдореГрджрд╛ рдХрд╛ рдкреАрдПрдЪ рджрд░реНрдЬ рдХрд░реЗрдВ)" step="0.01" class="border p-2 mb-2 w-full" required />
    <input type="text" name="current_crop" placeholder="Current Crop (рд╡рд░реНрддрдорд╛рди рдлрд╕рд▓) (Optional)" class="border p-2 mb-2 w-full" />
    <input type="text" name="stage" placeholder="Growth Stage (рд╡рд┐рдХрд╛рд╕ рдЪрд░рдг) (Optional)" class="border p-2 mb-2 w-full" />
    <input type="number" step="0.01" name="kc" placeholder="Crop Coefficient (Kc) (рдлрд╕рд▓ рдЧреБрдгрд╛рдВрдХ) (Optional)" class="border p-2 mb-2 w-full" />
    <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Get Recommendation (рд╕рд┐рдлрд╛рд░рд┐рд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ)</button>
</form>

<!-- Crop Recommendation Result -->
{% if result %}
<div class="bg-white p-4 rounded shadow mb-6">
  <h2 class="text-xl font-bold mb-2">ЁЯМ╛ Recommended Crop (рдЕрдиреБрд╢рдВрд╕рд┐рдд рдлрд╕рд▓): {{ result.crop }}</h2>

  <p><strong>ЁЯМ┐ Microbial Biodiversity (рд╕реВрдХреНрд╖реНрдо рдЬреИрд╡ рд╡рд┐рд╡рд┐рдзрддрд╛):</strong> {{ result.microbial_health }}</p>

  <div class="mt-2">
    <h3 class="text-lg font-semibold">ЁЯзк Estimated Current Nutrient Levels (рд╡рд░реНрддрдорд╛рди рдкреЛрд╖рдХ рддрддреНрд╡ рд╕реНрддрд░ рдХрд╛ рдЕрдиреБрдорд╛рди) (kg/ha):</h3>
    <ul class="ml-4 list-disc">
      <li><strong>Nitrogen (рдирд╛рдЗрдЯреНрд░реЛрдЬрди):</strong> {{ result.nutrients.N }}</li>
      <li><strong>Phosphorus (рдлрд╛рд╕реНрдлреЛрд░рд╕):</strong> {{ result.nutrients.P }}</li>
      <li><strong>Potassium (рдкреЛрдЯреЗрд╢рд┐рдпрдо):</strong> {{ result.nutrients.K }}</li>
      <li><strong>Sulfur (рд╕рд▓реНрдлрд░):</strong> {{ result.nutrients.S }}</li>
    </ul>
    <p class="text-sm text-gray-500 italic mt-1">These values are estimated based on your soil pH and local conditions. (рдпреЗ рдорд╛рди рдЖрдкрдХреЗ рдореГрджрд╛ рдкреАрдПрдЪ рдФрд░ рд╕реНрдерд╛рдиреАрдп рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВред)</p>
  </div>

  {% if result.weather %}
  <div class="mt-4">
    <h3 class="text-lg font-semibold">ЁЯМж Weather Data (рдореМрд╕рдо рдбреЗрдЯрд╛):</h3>
    <p>Temperature (рддрд╛рдкрдорд╛рди): {{ result.weather.temperature }} ┬░C</p>
    <p>Humidity (рдЖрд░реНрджреНрд░рддрд╛): {{ result.weather.humidity }} %</p>
    <p>Rainfall (рд╡рд░реНрд╖рд╛): {{ result.weather.precip }} mm</p>
    <p>Condition (рд╕реНрдерд┐рддрд┐): {{ result.weather.condition }}</p>
  </div>
  {% endif %}

  <div class="mt-4">
    <h3 class="text-lg font-semibold">ЁЯза Why this crop? (рдпрд╣ рдлрд╕рд▓ рдХреНрдпреЛрдВ?)</h3>
    <p>{{ result.explanation }}</p>
  </div>

  <div class="mt-4">
    <h3 class="text-lg font-semibold">ЁЯФБ Suggested Next Crop (рд╕реБрдЭрд╛рдИ рдЧрдИ рдЕрдЧрд▓реА рдлрд╕рд▓):</h3>
    <p class="mb-1">{{ result.next_crop }}</p>
    <p class="text-sm text-gray-500 italic">Selected based on nutrient rotation logic, soil pH, weather, and location to ensure long-term soil sustainability. (рд▓рдВрдмреА рдЕрд╡рдзрд┐ рдХреА рдореГрджрд╛ рд╕реНрдерд┐рд░рддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрдпрди рдХрд┐рдпрд╛ рдЧрдпрд╛ред)</p>
  </div>
</div>
{% endif %}

<!-- Problem Finder Form -->
<form action="/problem-finder" method="POST" class="bg-white p-4 rounded-lg shadow">
  <h2 class="text-xl font-semibold mb-2">ЁЯФН Problem Finder (рд╕рдорд╕реНрдпрд╛ рдЦреЛрдЬрдХ)</h2>
  <input type="text" name="current_crop" placeholder="Current Crop (рд╡рд░реНрддрдорд╛рди рдлрд╕рд▓)" class="border p-2 mb-2 w-full" required />
  <input type="text" name="location" placeholder="Location (рд╕реНрдерд╛рди)" class="border p-2 mb-2 w-full" required />
  <input type="number" name="ph" placeholder="Soil pH (рдореГрджрд╛ рдкреАрдПрдЪ)" step="0.01" class="border p-2 mb-2 w-full" required />
  <input type="number" name="nitrogen" placeholder="Nitrogen Content (рдирд╛рдЗрдЯреНрд░реЛрдЬрди) (kg/ha)" class="border p-2 mb-2 w-full" step="0.01" required>
  <input type="number" name="phosphorus" placeholder="Phosphorus Content (рдлрд╛рд╕реНрдлреЛрд░рд╕) (kg/ha)" class="border p-2 mb-2 w-full" step="0.01" required>
  <input type="number" name="potassium" placeholder="Potassium Content (рдкреЛрдЯреЗрд╢рд┐рдпрдо) (kg/ha)" class="border p-2 mb-2 w-full" step="0.01" required>
  <input type="number" name="sulfur" placeholder="Sulfur Content (рд╕рд▓реНрдлрд░) (kg/ha)" class="border p-2 mb-2 w-full" step="0.01" required>
  <input type="text" name="fertilizer" placeholder="Current Fertilizer (рд╡рд░реНрддрдорд╛рди рдЙрд░реНрд╡рд░рдХ)" class="border p-2 mb-2 w-full" required />
  <button type="submit" class="bg-yellow-600 text-white px-4 py-2 rounded">Find Problems (рд╕рдорд╕реНрдпрд╛рдПрдБ рдЦреЛрдЬреЗрдВ)</button>
</form>

<!-- Problem Finder Output -->
{% if fertilizer_result %}
<div class="bg-white p-4 mt-4 rounded shadow">
  <h2 class="text-xl font-semibold mb-2">ЁЯй║ Diagnosis Result (рдирд┐рджрд╛рди рдкрд░рд┐рдгрд╛рдо)</h2>

  {% if fertilizer_result.diagnosis.issues %}
  <ul class="list-disc pl-6 text-gray-800">
    {% for issue in fertilizer_result.diagnosis.issues %}
    <li class="mb-3">
      <strong>ЁЯе╝ Nutrient (рдкреЛрд╖рдХ рддрддреНрд╡):</strong> {{ issue.nutrient }}<br>
      <strong>ЁЯзк Expected (рдЕрдкреЗрдХреНрд╖рд┐рдд):</strong> {{ issue.expected }} | <strong>Actual (рд╡рд╛рд╕реНрддрд╡рд┐рдХ):</strong> {{ issue.actual }}<br>
      <strong>тЪая╕П Problem (рд╕рдорд╕реНрдпрд╛):</strong> {{ issue.problem }}<br>
      <strong>ЁЯзн Cause (рдХрд╛рд░рдг):</strong> {{ issue.cause }}<br>
      <strong>ЁЯТб Solution (рд╕рдорд╛рдзрд╛рди):</strong> {{ issue.solution }}<br>
      <strong>ЁЯМ▒ Suggested Fertilizer (рд╕реБрдЭрд╛рдпрд╛ рдЧрдпрд╛ рдЙрд░реНрд╡рд░рдХ):</strong> {{ issue.better_fertilizer }}
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p class="text-green-600 font-medium">тЬЕ Analysis Completed! (рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдкреВрд░рд╛ рд╣реБрдЖ!)</p>
  {% endif %}

  {% if fertilizer_result.web_result %}
  <div class="mt-4">
    <h3 class="text-lg font-semibold">ЁЯзл Recommended Fertilizer (рдЕрдиреБрд╢рдВрд╕рд┐рдд рдЙрд░реНрд╡рд░рдХ)</h3>
    <p><strong>ЁЯФД From (рд╕реЗ):</strong> {{ fertilizer_result.web_result.current_fertilizer or "Urea" }}</p>
    <p><strong>тЮбя╕П To (рддрдХ):</strong> {{ fertilizer_result.web_result.recommended_fertilizer or "Not specified" }}</p>
  </div>
  
  <div class="mt-4">
    <h3 class="text-lg font-semibold">ЁЯМ┐ Suggested Next Crop (рд╕реБрдЭрд╛рдИ рдЧрдИ рдЕрдЧрд▓реА рдлрд╕рд▓)</h3>
    <p>{{ fertilizer_result.web_result.next_crop or "Not available" }}</p>
  </div>
  
  {% if fertilizer_result.web_result.best_fertilizer %}
  <div class="mt-4">
    <h3 class="text-lg font-semibold">ЁЯеЗ Best Fertilizer from Database (рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рд╕рд░реНрд╡реЛрддреНрддрдо рдЙрд░реНрд╡рд░рдХ)</h3>
    <ul class="ml-4 list-disc">
      <li><strong>Name (рдирд╛рдо):</strong> {{ fertilizer_result.web_result.best_fertilizer.name or "N/A" }}</li>
      <li><strong>N (%):</strong> {{ fertilizer_result.web_result.best_fertilizer.N or "N/A" }}</li>
      <li><strong>P<sub>2</sub>O<sub>5</sub> (%):</strong> {{ fertilizer_result.web_result.best_fertilizer.P or "N/A" }}</li>
      <li><strong>K<sub>2</sub>O (%):</strong> {{ fertilizer_result.web_result.best_fertilizer.K or "N/A" }}</li>
      <li><strong>Category (рд╢реНрд░реЗрдгреА):</strong> {{ fertilizer_result.web_result.best_fertilizer.category or "N/A" }}</li>
      <li><strong>Use (рдЙрдкрдпреЛрдЧ):</strong> {{ fertilizer_result.web_result.best_fertilizer.use or "N/A" }}</li>
    </ul>
  </div>
  {% endif %}
  {% endif %}

  {% if fertilizer_result.dosage_recommendation %}
  <div class="mt-4">
    <h3 class="text-lg font-semibold">ЁЯзм Smart Fertilizer Recommendation (рд╕реНрдорд╛рд░реНрдЯ рдЙрд░реНрд╡рд░рдХ рд╕рд┐рдлрд╛рд░рд┐рд╢)</h3>
    <ul class="ml-4 list-disc">
      {% for key, value in fertilizer_result.dosage_recommendation.items() %}
      <li><strong>{{ key }}:</strong> {{ value }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {% if fertilizer_result.adjusted_dosage %}
  <div class="mt-4">
    <h3 class="text-lg font-semibold">тЪЦя╕П Adjusted Fertilizer Dosage (рд╕рдорд╛рдпреЛрдЬрд┐рдд рдЙрд░реНрд╡рд░рдХ рдорд╛рддреНрд░рд╛)</h3>
    <ul class="ml-4 list-disc">
      {% for key, value in fertilizer_result.adjusted_dosage.items() %}
      <li><strong>{{ key }}:</strong> {{ value }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
</div>
{% endif %}

<!-- Water Requirement Form -->
<form method="POST" action="/water-requirement" class="my-6 p-4 bg-green-100 rounded-xl">
  <h2 class="text-lg font-semibold mb-2">Estimate Water Requirement (рдкрд╛рдиреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдПрдВ)</h2>
  <div class="flex flex-col sm:flex-row gap-4">
    <input type="text" name="location" placeholder="Enter location (рд╕реНрдерд╛рди рджрд░реНрдЬ рдХрд░реЗрдВ)" class="p-2 rounded border border-gray-300 w-full sm:w-1/2" required>
    <input type="text" name="crop" placeholder="Enter crop (рдлрд╕рд▓ рджрд░реНрдЬ рдХрд░реЗрдВ)" class="p-2 rounded border border-gray-300 w-full sm:w-1/2" required>
    <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded">Analyze (рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ)</button>
  </div>
</form>

<!-- Show Water Requirement Graph -->
{% if water_plot %}
<div class="my-4">
  <h3 class="text-md font-semibold mb-2">
    Water Requirement Plot (рдкрд╛рдиреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдЧреНрд░рд╛рдл) for {{ crop }} ({{ stage }} stage, Kc={{ kc }}) in {{ location }}
  </h3>
  <img src="{{ url_for('static', filename=water_plot) }}" alt="Water Requirement Plot" class="w-full rounded shadow">
</div>
{% endif %}

</div>
</body>
</html>
